machine:
  node:
    version: "6"
test:
  override:
    - npm test
  post:
    - bash <(curl -s https://codecov.io/bash)
    - if [ $CIRCLE_BRANCH = 'master' ]; then npm run build; else true; fi
    - if [ $CIRCLE_BRANCH = 'master' ]; then rm -rd node_modules; else true; fi
    - if [ $CIRCLE_BRANCH = 'master' ]; then nvm use 4; else true; fi
    - if [ $CIRCLE_BRANCH = 'master' ]; then npm install; else true; fi
    - if [ $CIRCLE_BRANCH = 'master' ]; then BABEL_ENV=node4 npm run build -- -d dist/node4; else true; fi
    - npm run semantic-release || true
